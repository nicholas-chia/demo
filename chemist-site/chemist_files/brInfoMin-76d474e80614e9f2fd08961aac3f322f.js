function lazyBrInfo($scope,$sce){var isThirdUser=($scope.userInfo.profileInfo.recognizedState);var isBRUser=($scope.userInfo.profileInfo.loggedIn==="true"&&$scope.userInfo.profileInd.isLoyaltyUser);$scope.defaultRewardMsg=true;$scope.showRewardMsg=true;var allowToCheckAbout=true;var allowDefaultAction=true;var thirdallowDefault=false;if($scope.userInfo.profileInfo.flow==="iso"){$scope.defaultRewardMsg=false;allowDefaultAction=false;}var rewardsDollar,rewardPoint=0,maxDollarValue;if($scope.userInfo.profileInfo.flow!=="iso"&&($scope.userInfo.profileInfo.recognizedState===true||$scope.userInfo.profileInfo.loggedIn==="true")){$scope.defaultRewardMsg=false;if(isBRUser||isThirdUser){if($scope.userInfo.profileInfo.loyaltyId){var svcUrlRw;if($scope.userInfo.profileInfo.loggedIn==="true"){svcUrlRw=Clazz.com.wag.config.commonUiConfig.availPoints.replace("<profileId>",$scope.userInfo.profileInfo.profileId);}else{svcUrlRw=Clazz.com.wag.config.commonUiConfig.availPoints.replace("<profileId>",0);}var rewardsAjaxCall=$.ajax({url:svcUrlRw,type:"get",success:function(res){loadRewardsInfoData(res);},error:function(){$scope.brRewardError=true;rewardRender();}});allowDefaultAction=false;}else{$scope.defaultRewardMsg=true;thirdallowDefault=true;}}else{$scope.nonbrRewardMsg=true;}if(!thirdallowDefault){$scope.defaultRewardMsg=false;}$scope.showRewardMsg=false;}if(allowDefaultAction){rewardRender();}function rewardRender(){var Content="";if($scope.brZeroRewardMsg){Content='<div><span><strong>Earn points and reward yourself!</strong ></span> <span><a class=click-handler href="/store/store/save/loyalty-points-offers.jsp">Shop offers</a></span></div>';}if($scope.defaultRewardMsg||$scope.nonbrRewardMsg){Content='<div><span><strong>Make every visit more rewarding.</strong></span> <span class="visible-xs"><a class=click-handler href=/register/loyalty_enroll.jsp?loyalty=enroll&from=BR&_requestid=39976>Join or link your membership</a></span> <span class="hidden-xs"><a class=click-handler href=/register/loyalty_enroll.jsp?loyalty=enroll&from=BR&_requestid=39976>Join or link your membership</a></span></div>';}if($scope.brExceedRewardMsg){Content="<div><span><strong>You have a $"+rewarsdollar+' reward!</strong></span> <span class="wag-br-reward-msg wag-br-redeem-span">Redeem at checkout</span></div>';}if($scope.brNotExceedRewardMsg){Content="<div><span><strong>You're only "+rewardPoint+" points away from a $"+maxDollarValue+" reward.</strong></span> <span><a class=click-handler href=/store/store/save/loyalty-points-offers.jsp>Shop offers</a></span></div>";if(maxDollarValue==="undefined"){Content='<span class="wag-br-reward-err">Check back later for points </span>';}}if($scope.brRewardError){Content='<span class="wag-br-reward-err">Check back later for points </span>';}$scope.brMsg=$sce.trustAsHtml(Content);setTimeout(function(){$scope.$apply();setTimeout(function(){$(".click-handler").click(function(){window.location.href=$(this).attr("href");});},500);},400);var brContentL='<div class="col-xs-12"><hr></div>';brContentL=brContentL+'<div class="col-xs-12">';brContentL=brContentL+'<div class="pull-left pl5"><figure><img width=40 height=37 src=/images/adaptive/share/images/balance-rewart-mobile.png alt=Balance Rewards /></figure></div>';brContentL=brContentL+'<div class="pull-left pl15 wag-br-reward-cont wag-text-grey text-left">'+Content+"</div>";brContentL=brContentL+"</div>";brContentL=brContentL+'<div class="col-xs-12"><hr></div>';$("div .wag-launchpad-more-lnk").prev().append(brContentL);}function loadRewardsInfoData(result){document.cookie="GMD3S=called;domain=.walgreens.com;path=/;";if($scope.userInfo.profileInfo.loyaltyId){if(result.estimatedValue&&result.estimatedValue!="undefined"){if(result.estimatedValue>="1"){$scope.brExceedRewardMsg=true;rewarsdollar=result.estimatedValue;}else{$scope.brNotExceedRewardMsg=true;rewardPoint=Number(result.rewardsProgress.maxPoints.replace(",",""))-Number(result.rewardsProgress.pointBalance.replace(",",""));}}else{if(result.rewardsProgress&&result.rewardsProgress.pointBalance&&(Number(result.rewardsProgress.pointBalance.replace(",",""))>0)){$scope.brNotExceedRewardMsg=true;rewardPoint=Number(result.rewardsProgress.maxPoints.replace(",",""))-Number(result.rewardsProgress.pointBalance.replace(",",""));}else{if(result.rewardsProgress&&result.rewardsProgress.pointBalance){$scope.brZeroRewardMsg=true;}else{$scope.brRewardError=true;}}}$scope.brRewardMsg=true;if(result.rewardsProgress!=="undefined"&&result.rewardsProgress.maxDollarValue!=="undefined"){maxDollarValue=result.rewardsProgress.maxDollarValue;}rewardRender();allowToCheckAbout=false;}else{$scope.nonbrRewardMsg=true;}}}